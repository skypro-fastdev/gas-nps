# Skypro NPS Manager

**Инструмент для обработки входящих NPS оценок. Написано на Google Apps Scripts**

## Возможности скрипта 

Принимает входящие сигналы с оценками NPS
Складывает их в активный месяц
Автоматически отвечает на оценки без комментариев в ММ
Позволяет управлять ответами и отправлять ответы в ММ
Загружает и анализирует переписку с пользователем из ММ
Загружает данные пользователя с сервера персонализации

### Установка

1 Загрузить код с помощью Clasp 

https://developers.google.com/apps-script/guides/clasp?hl=ru

```bash
npm install @google/clasp -g
clasp login
git clone <URL>
clasp clone <ID>
clasp push

```

### 2 Настроить проект

Заходим в настройки проекта, задаем конфиги:

```
APIBASICTOKEN

CHATBOTCHATID
CHATBOTTOKEN
LAMBDA_TOKEN    

OPENAIKEY

SLAVA_TOKEN
SLAVA_ID
```

### 3 Все проверить

- Перезагрузить документ. 

- Выбрать "Обработать NPS в меню"

- Выбрать "Проверить здоровье таблиц и скриптов"

- Исправить ошибки

Документ при запуске потребует права на:

- работу с сетью
- поднятие хттп-сервера
- работу с локальными переменными